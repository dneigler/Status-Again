/// <reference path="api/jquery-1.7.1.min.js" />
/// <reference path="api/jquery.validate.min.js" />
/// <reference path="api/knockout-2.0.0.js" />
/// <reference path="api/jquery-ui-1.8.16.min.js" />
/// <reference path="api/jquery.autoresize.js" />
/// <reference path="api/date.js" />
/// <reference path="api/jquery.hotkeys.js" />
/// <reference path="api/tag-it.js" />
/// <reference path="../core/StatusReport.js" />

StatusReportTest = TestCase("StatusReportTest");

StatusReportTest.prototype.testGreet = function() {
	var sr = new statusReport();
	assertEquals(0, sr.Tags().length);
};

StatusReportTest.prototype.testUpdateChangeTracking = function () {
    var sr = new statusReport();
    var json = '{"StatusReportDates":["\/Date(1322456400000)\/","\/Date(1321851600000)\/","\/Date(1321246800000)\/","\/Date(1320642000000)\/"],"Id":4,"PeriodStart":"\/Date(1322456400000)\/","Caption":"Status report for 11/28/2011","NumberOfStatusItems":3,"Items":[{"Id":285,"StatusReportId":0,"TopicCaption":"Sample Caption Text","TopicExternalId":null,"TopicId":268,"MilestoneType":3,"MilestoneDate":null,"MilestoneConfidenceLevel":0,"Caption":"Sample Caption Text (TBD)","TagsString":"","Notes":[{"Id":285,"Text":"Sample Caption Text","AuditInfo":{"Author":{"Id":6,"FirstName":"First","LastName":"Last","FullName":"First Last","EmailAddress":"TESTPC\Administrator@test.com"},"AuditTime":"\/Date(1328064270000)\/","MachineName":"TESTPC"}}],"ProjectId":2,"ProjectName":"Hardware Migration","ProjectDepartmentName":"Department","ProjectDepartmentManagerFullName":"First Last","ProjectType":0,"ProjectTeamId":1,"ProjectTeamName":"Management","ProjectTeamLeadFullName":"Manager TestName","ProjectLeadFullName":"Manager TestName","ProjectCaption":"$30,000.00","ProjectDescription":null,"ProjectYear":0,"ProjectStartDate":null,"ProjectEndDate":null,"ProjectBudget":0.00000,"ProjectWikiLocation":null,"ProjectJiraLocation":null,"ProjectJiraProject":null},{"Id":286,"StatusReportId":0,"TopicCaption":"Server hardware expansion","TopicExternalId":null,"TopicId":269,"MilestoneType":1,"MilestoneDate":"\/Date(1322629200000)\/","MilestoneConfidenceLevel":0,"Caption":"Server hardware expansion (11/30)","TagsString":"","Notes":[{"Id":286,"Text":"Server hardware expansion","AuditInfo":{"Author":{"SamAccountName":null,"UserPrincipalName":null,"VoiceTelephoneNumber":null,"Description":null,"DisplayName":null,"DistinguishedName":null,"Guid":null,"Name":null,"MiddleName":null,"Sid":null,"EdsId":null,"Team":null,"Title":0,"WindowsLogin":"TESTPC\Administrator","Id":6,"FirstName":"First","LastName":"Last","FullName":"First Last","EmailAddress":"TESTPC\Administrator@test.com"},"AuditTime":"\/Date(1328064270000)\/","MachineName":"TESTPC"}}],"ProjectId":38,"ProjectName":"Capacity Expansion TestProject","ProjectDepartmentName":"Department","ProjectDepartmentManagerFullName":"First Last","ProjectType":0,"ProjectTeamId":1,"ProjectTeamName":"Management","ProjectTeamLeadFullName":"Manager TestName","ProjectLeadFullName":"Manager TestName","ProjectCaption":"$0.00","ProjectDescription":null,"ProjectYear":0,"ProjectStartDate":null,"ProjectEndDate":null,"ProjectBudget":0.00000,"ProjectWikiLocation":null,"ProjectJiraLocation":null,"ProjectJiraProject":null},{"Id":287,"StatusReportId":0,"TopicCaption":"Investigate hosting Griton and/or Geneva valuation data in a cube for Ops research purposes (transparency reporting for Ariel)","TopicExternalId":null,"TopicId":4,"MilestoneType":3,"MilestoneDate":null,"MilestoneConfidenceLevel":0,"Caption":"Investigate hosting Griton and/or Geneva valuation data in a cube for Ops research purposes (transparency reporting for Ariel) (TBD)","TagsString":"","Notes":[{"Id":287,"Text":"Investigate hosting Griton and/or Geneva valuation data in a cube for Ops research purposes (transparency reporting for Ariel)","AuditInfo":{"Author":{"SamAccountName":null,"UserPrincipalName":null,"VoiceTelephoneNumber":null,"Description":null,"DisplayName":null,"DistinguishedName":null,"Guid":null,"Name":null,"MiddleName":null,"Sid":null,"EdsId":null,"Team":null,"Title":0,"WindowsLogin":"TESTPC\Administrator","Id":6,"FirstName":"First","LastName":"Last","FullName":"First Last","EmailAddress":"TESTPC\Administrator@test.com"},"AuditTime":"\/Date(1328064270000)\/","MachineName":"TESTPC"}}],"ProjectId":4,"ProjectName":"Operations Cube","ProjectDepartmentName":"Department","ProjectDepartmentManagerFullName":"First Last","ProjectType":0,"ProjectTeamId":1,"ProjectTeamName":"Management","ProjectTeamLeadFullName":"Manager TestName","ProjectLeadFullName":"Manager TestName","ProjectCaption":"$0.00","ProjectDescription":null,"ProjectYear":0,"ProjectStartDate":null,"ProjectEndDate":null,"ProjectBudget":0.00000,"ProjectWikiLocation":null,"ProjectJiraLocation":null,"ProjectJiraProject":null}],"ItemsToRemove":null,"Projects":[{"Name":"Software Licensing","Id":1,"ProjectTeamId":0,"TeamId":1,"TeamName":"Management","TeamLeadFullName":"Manager TestName","LeadId":1,"LeadFullName":"Manager TestName","Caption":"$0.00","Description":null,"TeamLeadId":1,"TeamDepartmentName":"Department"},{"Name":"Hardware Migration","Id":2,"ProjectTeamId":0,"TeamId":1,"TeamName":"Management","TeamLeadFullName":"Manager TestName","LeadId":1,"LeadFullName":"Manager TestName","Caption":"$30,000.00","Description":null,"TeamLeadId":1,"TeamDepartmentName":"Department"},{"Name":"High Availability","Id":3,"ProjectTeamId":0,"TeamId":1,"TeamName":"Management","TeamLeadFullName":"Manager TestName","LeadId":1,"LeadFullName":"Manager TestName","Caption":"$30,000.00","Description":null,"TeamLeadId":1,"TeamDepartmentName":"Department"},{"Name":"Operations Cube","Id":4,"ProjectTeamId":0,"TeamId":1,"TeamName":"Management","TeamLeadFullName":"Manager TestName","LeadId":1,"LeadFullName":"Manager TestName","Caption":"$0.00","Description":null,"TeamLeadId":1,"TeamDepartmentName":"Department"},{"Name":"Operations Run","Id":5,"ProjectTeamId":0,"TeamId":1,"TeamName":"Management","TeamLeadFullName":"Manager TestName","LeadId":1,"LeadFullName":"Manager TestName","Caption":"$419,843.75","Description":null,"TeamLeadId":1,"TeamDepartmentName":"Department"},{"Name":"SACBOAPP Server Refresh","Id":6,"ProjectTeamId":0,"TeamId":1,"TeamName":"Management","TeamLeadFullName":"Manager TestName","LeadId":1,"LeadFullName":"Manager TestName","Caption":"$0.00","Description":null,"TeamLeadId":1,"TeamDepartmentName":"Department"},{"Name":"Triton SQL Server","Id":7,"ProjectTeamId":0,"TeamId":1,"TeamName":"Management","TeamLeadFullName":"Manager TestName","LeadId":1,"LeadFullName":"Manager TestName","Caption":"$0.00","Description":null,"TeamLeadId":1,"TeamDepartmentName":"Department"},{"Name":"KPM Trade Capture Report","Id":8,"ProjectTeamId":0,"TeamId":2,"TeamName":"Outgoing Feeds","TeamLeadFullName":"Jerry Hikel","LeadId":2,"LeadFullName":"Jerry Hikel","Caption":"$86,250.00","Description":null,"TeamLeadId":2,"TeamDepartmentName":"Department"},{"Name":"Omgeo TNG Migration","Id":9,"ProjectTeamId":0,"TeamId":2,"TeamName":"Outgoing Feeds","TeamLeadFullName":"Jerry Hikel","LeadId":2,"LeadFullName":"Jerry Hikel","Caption":"$38,750.00","Description":null,"TeamLeadId":2,"TeamDepartmentName":"Department"},{"Name":"OTC Executing Broker","Id":10,"ProjectTeamId":0,"TeamId":2,"TeamName":"Outgoing Feeds","TeamLeadFullName":"Jerry Hikel","LeadId":2,"LeadFullName":"Jerry Hikel","Caption":"$0.00","Description":null,"TeamLeadId":2,"TeamDepartmentName":"Department"},{"Name":"SEC Registration","Id":11,"ProjectTeamId":0,"TeamId":2,"TeamName":"Outgoing Feeds","TeamLeadFullName":"Jerry Hikel","LeadId":2,"LeadFullName":"Jerry Hikel","Caption":"$66,875.00","Description":null,"TeamLeadId":2,"TeamDepartmentName":"Department"},{"Name":"Swap/PB Financing","Id":12,"ProjectTeamId":0,"TeamId":2,"TeamName":"Outgoing Feeds","TeamLeadFullName":"Jerry Hikel","LeadId":2,"LeadFullName":"Jerry Hikel","Caption":"$322,656.25","Description":null,"TeamLeadId":2,"TeamDepartmentName":"Department"},{"Name":"FX Process Improvements","Id":13,"ProjectTeamId":0,"TeamId":2,"TeamName":"Outgoing Feeds","TeamLeadFullName":"Jerry Hikel","LeadId":2,"LeadFullName":"Jerry Hikel","Caption":"$12,812.50","Description":null,"TeamLeadId":2,"TeamDepartmentName":"Department"},{"Name":"Omgeo Quantarb Implementation","Id":14,"ProjectTeamId":0,"TeamId":2,"TeamName":"Outgoing Feeds","TeamLeadFullName":"Jerry Hikel","LeadId":2,"LeadFullName":"Jerry Hikel","Caption":"$45,312.50","Description":null,"TeamLeadId":2,"TeamDepartmentName":"Department"},{"Name":"Operations Run (ND)","Id":15,"ProjectTeamId":0,"TeamId":2,"TeamName":"Outgoing Feeds","TeamLeadFullName":"Jerry Hikel","LeadId":2,"LeadFullName":"Jerry Hikel","Caption":"$414,531.25","Description":null,"TeamLeadId":2,"TeamDepartmentName":"Department"},{"Name":"PanGenLoader Replacement","Id":16,"ProjectTeamId":0,"TeamId":2,"TeamName":"Outgoing Feeds","TeamLeadFullName":"Jerry Hikel","LeadId":2,"LeadFullName":"Jerry Hikel","Caption":"$217,500.00","Description":null,"TeamLeadId":2,"TeamDepartmentName":"Department"},{"Name":"10B10 Confirmation File Process","Id":17,"ProjectTeamId":0,"TeamId":2,"TeamName":"Outgoing Feeds","TeamLeadFullName":"Jerry Hikel","LeadId":2,"LeadFullName":"Jerry Hikel","Caption":"$0.00","Description":null,"TeamLeadId":2,"TeamDepartmentName":"Department"},{"Name":"Close Process 2011 Improvements","Id":18,"ProjectTeamId":0,"TeamId":2,"TeamName":"Outgoing Feeds","TeamLeadFullName":"Jerry Hikel","LeadId":2,"LeadFullName":"Jerry Hikel","Caption":"$0.00","Description":null,"TeamLeadId":2,"TeamDepartmentName":"Department"},{"Name":"Geneva amend report modification / Griton VX","Id":19,"ProjectTeamId":0,"TeamId":3,"TeamName":"Transaction Processing & Core","TeamLeadFullName":"Mark Nadelson","LeadId":3,"LeadFullName":"Mark Nadelson","Caption":"$0.00","Description":null,"TeamLeadId":3,"TeamDepartmentName":"Department"},{"Name":"Triton Migration to Linux","Id":20,"ProjectTeamId":0,"TeamId":3,"TeamName":"Transaction Processing & Core","TeamLeadFullName":"Mark Nadelson","LeadId":3,"LeadFullName":"Mark Nadelson","Caption":"$0.00","Description":null,"TeamLeadId":3,"TeamDepartmentName":"Department"},{"Name":"Triton Run","Id":21,"ProjectTeamId":0,"TeamId":3,"TeamName":"Transaction Processing & Core","TeamLeadFullName":"Mark Nadelson","LeadId":3,"LeadFullName":"Mark Nadelson","Caption":"$505,625.00","Description":null,"TeamLeadId":3,"TeamDepartmentName":"Department"},{"Name":"Local Currency Exposure 2011","Id":22,"ProjectTeamId":0,"TeamId":4,"TeamName":"Middle Office Reconciliation & Workflow","TeamLeadFullName":"Terrence Nirmaier","LeadId":4,"LeadFullName":"Terrence Nirmaier","Caption":"$128,750.00","Description":null,"TeamLeadId":4,"TeamDepartmentName":"Department"},{"Name":"PGL - DataMart to Triton Feed","Id":23,"ProjectTeamId":0,"TeamId":4,"TeamName":"Middle Office Reconciliation & Workflow","TeamLeadFullName":"Terrence Nirmaier","LeadId":4,"LeadFullName":"Terrence Nirmaier","Caption":"$60,000.00","Description":null,"TeamLeadId":4,"TeamDepartmentName":"Department"},{"Name":"Pricing Discrepancy Tool","Id":24,"ProjectTeamId":0,"TeamId":4,"TeamName":"Middle Office Reconciliation & Workflow","TeamLeadFullName":"Terrence Nirmaier","LeadId":4,"LeadFullName":"Terrence Nirmaier","Caption":"$0.00","Description":null,"TeamLeadId":4,"TeamDepartmentName":"Department"},{"Name":"QDI Phase 2","Id":25,"ProjectTeamId":0,"TeamId":5,"TeamName":"Tax","TeamLeadFullName":"Winston Chao","LeadId":5,"LeadFullName":"Winston Chao","Caption":"$20,000.00","Description":null,"TeamLeadId":5,"TeamDepartmentName":"Department"},{"Name":"CSI Modifications","Id":26,"ProjectTeamId":0,"TeamId":6,"TeamName":"Geneva","TeamLeadFullName":"Winston Chao","LeadId":5,"LeadFullName":"Winston Chao","Caption":"$15,000.00","Description":null,"TeamLeadId":5,"TeamDepartmentName":"Department"},{"Name":"Fund Ad/Financial Reporting Run","Id":27,"ProjectTeamId":0,"TeamId":7,"TeamName":"Financial Reporting","TeamLeadFullName":"Winston Chao","LeadId":5,"LeadFullName":"Winston Chao","Caption":"$140,000.00","Description":null,"TeamLeadId":5,"TeamDepartmentName":"Department"},{"Name":"Geneva Transactions to IntelliMatch issues","Id":28,"ProjectTeamId":0,"TeamId":8,"TeamName":"IntelliMatch","TeamLeadFullName":"Winston Chao","LeadId":5,"LeadFullName":"Winston Chao","Caption":"$40,000.00","Description":null,"TeamLeadId":5,"TeamDepartmentName":"Department"},{"Name":"NAV Rollforward","Id":29,"ProjectTeamId":0,"TeamId":6,"TeamName":"Geneva","TeamLeadFullName":"Winston Chao","LeadId":5,"LeadFullName":"Winston Chao","Caption":"$170,000.00","Description":null,"TeamLeadId":5,"TeamDepartmentName":"Department"},{"Name":"Dream Run","Id":30,"ProjectTeamId":0,"TeamId":8,"TeamName":"IntelliMatch","TeamLeadFullName":"Winston Chao","LeadId":5,"LeadFullName":"Winston Chao","Caption":"$186,093.75","Description":null,"TeamLeadId":5,"TeamDepartmentName":"Department"},{"Name":"IntelliMatch Security Reject Passthrough","Id":31,"ProjectTeamId":0,"TeamId":6,"TeamName":"Geneva","TeamLeadFullName":"Winston Chao","LeadId":5,"LeadFullName":"Winston Chao","Caption":"$0.00","Description":null,"TeamLeadId":5,"TeamDepartmentName":"Department"},{"Name":"ML Swap Files to IntelliMatch","Id":32,"ProjectTeamId":0,"TeamId":8,"TeamName":"IntelliMatch","TeamLeadFullName":"Winston Chao","LeadId":5,"LeadFullName":"Winston Chao","Caption":"$5,000.00","Description":null,"TeamLeadId":5,"TeamDepartmentName":"Department"},{"Name":"Tax Run","Id":33,"ProjectTeamId":0,"TeamId":5,"TeamName":"Tax","TeamLeadFullName":"Winston Chao","LeadId":5,"LeadFullName":"Winston Chao","Caption":"$175,000.00","Description":null,"TeamLeadId":5,"TeamDepartmentName":"Department"},{"Name":"Automation of Month End Revenue/Expenses in Geneva","Id":34,"ProjectTeamId":0,"TeamId":8,"TeamName":"IntelliMatch","TeamLeadFullName":"Winston Chao","LeadId":5,"LeadFullName":"Winston Chao","Caption":"$93,593.75","Description":null,"TeamLeadId":5,"TeamDepartmentName":"Department"},{"Name":"Geneva Run","Id":35,"ProjectTeamId":0,"TeamId":6,"TeamName":"Geneva","TeamLeadFullName":"Winston Chao","LeadId":5,"LeadFullName":"Winston Chao","Caption":"$40,000.00","Description":null,"TeamLeadId":5,"TeamDepartmentName":"Department"},{"Name":"Macquarie T+1 files","Id":36,"ProjectTeamId":0,"TeamId":6,"TeamName":"Geneva","TeamLeadFullName":"Winston Chao","LeadId":5,"LeadFullName":"Winston Chao","Caption":"$0.00","Description":null,"TeamLeadId":5,"TeamDepartmentName":"Department"},{"Name":"Associates Geneva consolidation","Id":37,"ProjectTeamId":0,"TeamId":6,"TeamName":"Geneva","TeamLeadFullName":"Winston Chao","LeadId":5,"LeadFullName":"Winston Chao","Caption":"$0.00","Description":null,"TeamLeadId":5,"TeamDepartmentName":"Department"},{"Name":"Capacity Expansion TestProject","Id":38,"ProjectTeamId":0,"TeamId":1,"TeamName":"Management","TeamLeadFullName":"Manager TestName","LeadId":1,"LeadFullName":"Manager TestName","Caption":"$0.00","Description":null,"TeamLeadId":1,"TeamDepartmentName":"Department"}],"Tags":[],"CanRollStatus":true,"RollStatusDate":"\/Date(1323061200000)\/"}';
    var pJson = $.parseJSON(json, true);
    // console.log(pJson);
    sr.initData(pJson);
    // testing report item
    assertNotNull("statusreport should be live", sr);
    // var sri = new statusReportItem();
    assert("Should be at least one status report item in collection.", sr.Items().length > 0);
    
    var sri = sr.Items()[0];
    var origValue = sri.Caption();
    sri.Caption("Changed Value");
    assert("First caption change should result in HasChanges === true", sri.HasChanges());
    sri.Caption("Another changed value");
    assert("Second caption change should result in HasChanges === true", sri.HasChanges());
    sri.Caption(origValue);
    assertFalse("Caption change back to original should result in HasChanges === false", sri.HasChanges());

};